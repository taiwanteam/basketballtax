<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>彰稅小籃手</title>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.55.2/dist/phaser.min.js"></script>
</head>

<body>
    <script>
var ballMoving=!1,currentQuestionIndex=0,correctAnswers=0;function parseCSV(e){var t=e.split("\n").map(e=>e.trim()).filter(e=>0<e.length),s=[];for(let e=1;e<t.length;e++){var i=t[e].split(",").map(e=>e.replace(/"/g,"").trim());s.push({question:i[0],options:[i[1],i[2],i[3]],correct:i[4]})}return s}function startGame(e){e.overlay.setVisible(!1),e.window.setVisible(!1),e.review.setVisible(!1),e.reviewText.setVisible(!1),e.text.setVisible(!1),e.startButton.setVisible(!1),e.scale.resize(window.innerWidth,window.innerHeight),createBasketballScene(e),e.startTime=e.time.now}function createBasketballScene(s){correctAnswersText=s.add.text(s.sys.game.config.width/8,s.sys.game.config.height/7,"答對題數: 0",{fontSize:"30px",fill:"#fff",fontFamily:"Arial, sans-serif"}).setOrigin(.5,.5),s.hoops=[];[{x:s.sys.game.config.width/4.2,y:s.sys.game.config.height/2},{x:s.sys.game.config.width/2.1,y:s.sys.game.config.height/2},{x:s.sys.game.config.width/4.2*3,y:s.sys.game.config.height/2}].forEach(e=>{let t=s.add.image(e.x,e.y,"hoop").setOrigin(.5,.5);t.setDisplaySize(200,200),t.answerText=s.add.text(e.x,e.y-60,"",{fontSize:"30px",fill:"#6495ED"}).setOrigin(.5).setDepth(3),s.physics.add.existing(t,!0),t.setInteractive(),t.on("pointerdown",function(){throwBasketball(s,t)}),s.hoops.push(t)}),(questionText=s.add.text(s.sys.game.config.width/2.1,s.sys.game.config.height/4,"",{fontSize:"45px",fill:"#00008B",fontFamily:"Microsoft YaHei Bold",fontWeight:"bold",stroke:"#FFFFFF",strokeThickness:6,lineSpacing:10}).setOrigin(.5,.5)).setDepth(3);var e=s.cache.text.get("questionsCSV");questions=parseCSV(e),questions=Phaser.Utils.Array.Shuffle([...questions]),loadNextQuestion(s),s.basketball=s.add.image(s.sys.game.config.width/2.1,s.sys.game.config.height-80,"basketball").setOrigin(.5,.5),s.basketball.setScale(.6),s.physics.add.existing(s.basketball,!0)}function loadNextQuestion(t){if(!(currentQuestionIndex>=questions.length)){var e=questions[currentQuestionIndex],s=(questionText.setText(e.question),Phaser.Utils.Array.Shuffle([...e.options]));for(let e=0;e<3;e++)t.hoops[e].answer=s[e],t.hoops[e].answerText.setText(s[e])}}let gameFinished=!1;function throwBasketball(s,i){if(!gameFinished&&!ballMoving){var e=i.getBounds();const n=e.x+e.width/2,o=e.y+e.height/6;s.tweens.add({targets:s.basketball,x:n,y:o,scale:.2,ease:"Quad.easeOut",duration:500,onComplete:()=>{var e,t;i.answer===questions[currentQuestionIndex].correct?(s.sound.play("right"),s.tweens.add({targets:s.basketball,y:o+50,alpha:0,ease:"Linear",duration:500,onComplete:()=>{correctAnswers++,correctAnswersText.setText("答對題數: "+correctAnswers),checkGameStatus(s)}})):(e=n+(.5<Math.random()?50:-50),t=o-100*Math.random()-50,s.sound.play("miss"),s.tweens.add({targets:s.basketball,x:e,y:t,ease:"Bounce.easeOut",duration:500,onComplete:()=>{checkGameStatus(s)}}))}})}}function checkGameStatus(e){(++currentQuestionIndex>=questions.length?(gameFinished=!0,correctAnswers===questions.length?showSuccessScreen:showLoseScreen):(resetBall(e),loadNextQuestion))(e)}function resetBall(e){e.basketball.setPosition(e.sys.game.config.width/2,e.sys.game.config.height-100),e.basketball.setScale(.5),e.basketball.setAlpha(1),e.basketball.setDepth(1),ballMoving=!1}function showSuccessScreen(t){t.graphics1=t.add.graphics(),t.graphics1.fillStyle(4286945,1),t.graphics1.fillRect(t.sys.game.config.width/2-250,t.sys.game.config.height/2-175,500,350),t.graphics1.setDepth(3);let e=t.add.text(t.sys.game.config.width/2,t.sys.game.config.height/2-130,"恭喜過關!",{fontSize:"45px",fill:"#fff",align:"center",fontFamily:"Arial, sans-serif"}).setOrigin(.5);e.setDepth(4);var s=(t.time.now-t.startTime)/1e3;t.add.text(t.sys.game.config.width/2,t.sys.game.config.height/2-80,"過關時間:"+s.toFixed(0)+"秒",{fontSize:"45px",fill:"#fff",align:"center",fontFamily:"Arial, sans-serif"}).setOrigin(.5).setDepth(4);let i=t.add.text(t.sys.game.config.width/2,t.sys.game.config.height/2,"Google表單",{fontSize:"50px",color:"#fff",fontFamily:"Arial, sans-serif",backgroundColor:"#FFDAB9",padding:{x:20,y:10}}).setOrigin(.5),n=(i.setDepth(5),i.setStroke("#000000",3),i.setInteractive(),i.on("pointerdown",()=>{window.open("https://forms.gle/your-google-form-link","_blank")}),i.on("pointerover",function(){i.setStyle({fill:"#f39c12"})}),i.on("pointerout",function(){i.setStyle({fill:"#fff"})}),t.add.text(t.sys.game.config.width/2,t.sys.game.config.height/2+100,"再挑戰一次",{fontSize:"50px",color:"#fff",fontFamily:"Arial, sans-serif",backgroundColor:"#FFDAB9",padding:{x:20,y:10}}).setOrigin(.5));n.setDepth(5),n.setStroke("#000000",3),n.setInteractive(),n.on("pointerdown",()=>{restartGame1(t,e,i,n)}),n.on("pointerover",function(){n.setStyle({fill:"#f39c12"})}),n.on("pointerout",function(){n.setStyle({fill:"#fff"})});for(let e=0;e<3;e++)t.hoops[e].setVisible(!1),t.hoops[e].answerText.destroy();t.basketball.setVisible(!1),questionText.destroy(),t.sound.play("allright")}function showLoseScreen(t){t.graphics1=t.add.graphics(),t.graphics1.fillStyle(4286945,1),t.graphics1.fillRect(t.sys.game.config.width/2-250,t.sys.game.config.height/2-200,500,350),t.graphics1.setDepth(3);let e=t.add.text(t.sys.game.config.width/2,t.sys.game.config.height/2-120,"加油再努力！",{fontSize:"50px",fill:"#fff",fontFamily:"Arial, sans-serif"}).setOrigin(.5);e.setDepth(4);var s=questions.length-correctAnswers;let i=t.add.text(t.sys.game.config.width/2,t.sys.game.config.height/2-20,"答錯題數:"+s+" 題",{fontSize:"50px",fill:"#fff",fontFamily:"Arial, sans-serif"}).setOrigin(.5),n=(i.setDepth(4),t.add.text(t.sys.game.config.width/2,t.sys.game.config.height/2+80,"再挑戰一次",{fontSize:"50px",color:"#fff",fontFamily:"Arial, sans-serif",backgroundColor:"#FFDAB9",padding:{x:20,y:10}}).setOrigin(.5));n.setDepth(5),n.setStroke("#000000",3),n.setInteractive(),n.on("pointerdown",()=>{restartGame(t,e,i,n)}),n.on("pointerover",function(){n.setStyle({fill:"#f39c12"})}),n.on("pointerout",function(){n.setStyle({fill:"#fff"})});for(let e=0;e<3;e++)t.hoops[e].setVisible(!1),t.hoops[e].answerText.destroy();t.basketball.setVisible(!1),questionText.destroy()}function restartGame(e,t,s,i){e.graphics1.clear(),t.destroy(),s.destroy(),i.destroy(),currentQuestionIndex=correctAnswers=0,gameFinished=!1;t=e.cache.text.get("questionsCSV");questions=parseCSV(t),questions=Phaser.Utils.Array.Shuffle([...questions]),e.scene.restart()}function restartGame1(e,t,s,i){e.graphics1.clear(),t.destroy(),s.destroy(),i.destroy(),currentQuestionIndex=correctAnswers=0,gameFinished=!1;t=e.cache.text.get("questionsCSV");questions=parseCSV(t),questions=Phaser.Utils.Array.Shuffle([...questions]),e.scene.restart()}var config={type:Phaser.AUTO,width:window.innerWidth,height:window.innerHeight,scale:{mode:Phaser.Scale.RESIZE,autoCenter:Phaser.Scale.CENTER_BOTH},physics:{default:"arcade",arcade:{gravity:{y:0},debug:!1}},scene:{preload:function(){this.load.image("background","assert/bnew.png"),this.load.image("hoop","assert/hoopnew.png"),this.load.image("basketball","assert/basketball.png"),this.load.text("questionsCSV","question/QA1.csv"),this.load.image("review","assert/review.png"),this.load.audio("right","assert/audio/right.mp3"),this.load.audio("miss","assert/audio/miss.mp3"),this.load.audio("allright","assert/audio/allright.mp3")},create:function(){let e=this;this.background=this.add.image(0,0,"background").setOrigin(0,0),this.background.setDisplaySize(this.sys.game.config.width,this.sys.game.config.height),this.overlay=this.add.graphics(),this.overlay.fillStyle(0,.5),this.overlay.fillRect(0,0,this.sys.game.config.width,this.sys.game.config.height),this.window=this.add.graphics(),this.window.fillStyle(4286945,1),this.window.fillRect(this.sys.game.config.width/2-250,this.sys.game.config.height/2-200,500,400),this.text=this.add.text(this.sys.game.config.width/2,this.sys.game.config.height/2-90,"挑戰彰稅小籃手！\n答對所有題目！\n截圖參加抽獎！",{font:"40px Arial",fill:"#fff",align:"center"}).setOrigin(.5),this.startButton=this.add.text(this.sys.game.config.width/2,this.sys.game.config.height/2+40,"Ready GO",{fontSize:"45px",color:"#fff",fontFamily:"Arial, sans-serif",backgroundColor:"#FFDAB9",padding:{x:10,y:5}}).setOrigin(.5).setDepth(4).setStroke("#000000",3).setInteractive(),this.startButton.on("pointerdown",function(){startGame(e)},this),this.startButton.on("pointerover",()=>{this.startButton.setStyle({fill:"#f39c12"})}),this.startButton.on("pointerout",()=>{this.startButton.setStyle({fill:"#fff"})}),this.review=this.add.image(this.sys.game.config.width/2,this.sys.game.config.height/2+135,"review").setInteractive().setDepth(5).setScale(.11).on("pointerdown",()=>{window.open("https://your-review-link.com","_blank")}),this.review.on("pointerover",()=>{this.review.setScale(.15)}),this.review.on("pointerout",()=>{this.review.setScale(.11)}),this.reviewText=this.add.text(this.sys.game.config.width/2,this.sys.game.config.height/2+135,"復習請按我",{fontSize:"20px",fill:"#fff",fontFamily:"Arial, sans-serif"}).setOrigin(.5).setDepth(5).setInteractive(),this.reviewText.on("pointerover",()=>{this.reviewText.setStyle({fill:"#f39c12"})}),this.reviewText.on("pointerout",()=>{this.reviewText.setStyle({fill:"#fff"})}),this.tweens.add({targets:this.reviewText,scale:{from:1,to:1.5},alpha:{from:1,to:.8},yoyo:!0,repeat:-1,duration:800,ease:"Sine.easeInOut"}),this.scale.on("resize",e=>{this.background.setDisplaySize(e.width,e.height),this.overlay.clear(),this.overlay.fillStyle(0,.5),this.overlay.fillRect(0,0,e.width,e.height),this.window.clear(),this.window.fillStyle(4286945,1),this.window.fillRect(e.width/2-250,e.height/2-200,500,400)})},update:function(){}}};new Phaser.Game(config);
    </script>
</body>

</html>